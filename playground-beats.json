{
  "$schema": "https://playground.wordpress.net/blueprint-schema.json",
  "landingPage": "/",
  "preferredVersions": {
    "php": "8.2",
    "wp": "6.8"
  },
  "steps": [
    {
      "step": "unzip",
      "zipFile": {
        "resource": "url",
        "url": "https://raw.githubusercontent.com/crystalthedeveloper/wordpress-beats-playground/main/assets/beats-upload-player.zip",
        "caption": "Bundling Beats Upload Player"
      },
      "extractToPath": "/wordpress/wp-content/plugins/"
    },
    {
      "step": "defineWpConfigConsts",
      "consts": {
        "WP_ENVIRONMENT_TYPE": "playground",
        "WP_PLAYGROUND": true,
        "IS_PLAYGROUND": true
      }
    },
    {
      "step": "activatePlugin",
      "pluginPath": "beats-upload-player/beats-upload-player.php"
    },
    {
      "step": "activateTheme",
      "themeFolderName": "twentytwentyfive"
    },
    {
      "step": "runPHP",
      "code": "require_once ABSPATH . 'wp-admin/includes/post.php';\nrequire_once ABSPATH . 'wp-admin/includes/theme.php';\nrequire_once ABSPATH . 'wp-admin/includes/template.php';\n\nif ( function_exists( 'beats_prime_data' ) ) {\n    beats_prime_data();\n} elseif ( function_exists( 'beats_seed_playground_demo' ) ) {\n    beats_seed_playground_demo();\n}\n\n$beats_section = <<<HTML\n<!-- wp:group {\"tagName\":\"main\",\"align\":\"full\",\"style\":{\"spacing\":{\"padding\":{\"top\":\"30px\",\"right\":\"20px\",\"bottom\":\"40px\",\"left\":\"20px\"}}}} -->\n<main class=\"wp-block-group alignfull\" style=\"padding-top:30px;padding-right:20px;padding-bottom:40px;padding-left:20px\">\n<!-- wp:group {\"align\":\"wide\",\"style\":{\"spacing\":{\"blockGap\":\"18px\",\"margin\":{\"top\":\"0\",\"bottom\":\"0\"},\"padding\":{\"top\":\"20px\",\"right\":\"20px\",\"bottom\":\"20px\",\"left\":\"20px\"}},\"border\":{\"radius\":\"16px\",\"color\":\"#f1f1f1\",\"width\":\"1px\"}},\"layout\":{\"type\":\"constrained\"}} -->\n<div class=\"wp-block-group alignwide\" style=\"border-color:#f1f1f1;border-width:1px;border-radius:16px;margin-top:0;margin-bottom:0;padding-top:20px;padding-right:20px;padding-bottom:20px;padding-left:20px\">\n<!-- wp:heading {\"textAlign\":\"center\"} -->\n<h2 class=\"wp-block-heading has-text-align-center\">Beats</h2>\n<!-- /wp:heading -->\n<!-- wp:paragraph {\"align\":\"center\"} -->\n<p class=\"has-text-align-center\">Preview every Beats shortcode below.</p>\n<!-- /wp:paragraph -->\n<!-- wp:group {\"style\":{\"spacing\":{\"blockGap\":\"12px\"}},\"layout\":{\"type\":\"constrained\"}} -->\n<div class=\"wp-block-group\" style=\"gap:12px\">\n<!-- wp:shortcode -->[beats_category_search]<!-- /wp:shortcode -->\n<!-- wp:shortcode -->[beats_visualizer]<!-- /wp:shortcode -->\n<!-- wp:shortcode -->[beats_display_home]<!-- /wp:shortcode -->\n<!-- wp:shortcode -->[beats_global_player]<!-- /wp:shortcode -->\n</div>\n<!-- /wp:group -->\n</div>\n<!-- /wp:group -->\n</main>\n<!-- /wp:group -->\nHTML;\n\n$theme      = wp_get_theme();\n$theme_slug = $theme->get_stylesheet();\n$templates  = array(\n    'home'       => 'Home',\n    'front-page' => 'Front Page',\n    'index'      => 'Index'\n);\n\n$template_wrapper = sprintf(\n    '<!-- wp:template-part {\"slug\":\"header\",\"theme\":\"%1$s\",\"area\":\"header\"} /-->%2$s<!-- wp:template-part {\"slug\":\"footer\",\"theme\":\"%1$s\",\"area\":\"footer\"} /-->',\n    esc_attr( $theme_slug ),\n    $beats_section\n);\n\nforeach ( $templates as $template_slug => $template_label ) {\n    $template_id = sprintf( '%s//%s', $theme_slug, $template_slug );\n\n    $template_args = array(\n        'post_title'   => $template_label,\n        'post_name'    => $template_id,\n        'post_status'  => 'publish',\n        'post_type'    => 'wp_template',\n        'post_content' => $template_wrapper,\n        'meta_input'   => array(\n            'origin' => 'custom'\n        )\n    );\n\n    $existing_template = get_page_by_path( $template_id, OBJECT, 'wp_template' );\n    if ( $existing_template ) {\n        $template_args['ID'] = $existing_template->ID;\n        $saved_id            = wp_update_post( $template_args );\n    } else {\n        $saved_id = wp_insert_post( $template_args );\n    }\n\n    if ( ! is_wp_error( $saved_id ) ) {\n        wp_set_post_terms( $saved_id, $theme_slug, 'wp_theme' );\n        echo $template_label . ' template updated (post ID ' . $saved_id . ').' . PHP_EOL;\n    } else {\n        echo 'Failed to update ' . $template_slug . ' template: ' . $saved_id->get_error_message() . PHP_EOL;\n    }\n}"
    }
  ]
}
