{
  "$schema": "https://playground.wordpress.net/blueprint-schema.json",
  "landingPage": "/",
  "preferredVersions": {
    "php": "8.2",
    "wp": "6.8"
  },
  "steps": [
    {
      "step": "unzip",
      "zipFile": {
        "resource": "url",
        "url": "https://raw.githubusercontent.com/crystalthedeveloper/wordpress-beats-playground/main/assets/beats-upload-player.zip",
        "caption": "Bundling Beats Upload Player"
      },
      "extractToPath": "/wordpress/wp-content/plugins/"
    },
    {
      "step": "defineWpConfigConsts",
      "consts": {
        "WP_ENVIRONMENT_TYPE": "playground",
        "WP_PLAYGROUND": true,
        "IS_PLAYGROUND": true
      }
    },
    {
      "step": "activatePlugin",
      "pluginPath": "beats-upload-player/beats-upload-player.php"
    },
    {
      "step": "activateTheme",
      "themeFolderName": "twentytwentyfive"
    },
    {
      "step": "runPHP",
      "code": "\nrequire_once ABSPATH . 'wp-admin/includes/post.php';\nrequire_once ABSPATH . 'wp-admin/includes/theme.php';\nrequire_once ABSPATH . 'wp-admin/includes/template.php';\n\nif ( function_exists( 'beats_prime_data' ) ) {\n    beats_prime_data();\n} elseif ( function_exists( 'beats_seed_playground_demo' ) ) {\n    beats_seed_playground_demo();\n}\n\nif ( ! function_exists( 'beats_seed_page' ) ) {\n    function beats_seed_page( array $page_args ) {\n        $author_id = get_current_user_id();\n        if ( ! $author_id ) {\n            $author_id = 1;\n        }\n\n        $defaults = array(\n            'post_status' => 'publish',\n            'post_type'   => 'page',\n            'post_author' => $author_id,\n        );\n\n        $page_args = array_merge( $defaults, $page_args );\n\n        $existing = get_page_by_path( $page_args['post_name'] );\n        if ( $existing ) {\n            $page_args['ID'] = $existing->ID;\n            $result = wp_update_post( wp_slash( $page_args ), true );\n            if ( is_wp_error( $result ) ) {\n                return $result;\n            }\n            return (int) $existing->ID;\n        }\n\n        return wp_insert_post( wp_slash( $page_args ), true );\n    }\n}\n\n$beats_blocks = array(\n    '<!-- wp:paragraph {\"align\":\"center\"} -->',\n    '<p class=\"has-text-align-center\">Preview the Beats library and player below.</p>',\n    '<!-- /wp:paragraph -->',\n    '<!-- wp:shortcode -->[beats_cltd_category_search]<!-- /wp:shortcode -->',\n    '<!-- wp:shortcode -->[beats_cltd_visualizer]<!-- /wp:shortcode -->',\n    '<!-- wp:shortcode -->[beats_cltd_display_home]<!-- /wp:shortcode -->',\n    '<!-- wp:shortcode -->[beats_cltd_global_player]<!-- /wp:shortcode -->'\n);\n\n$beats_content = implode(\"\\n\", $beats_blocks);\n\n$upload_blocks = array(\n    '<!-- wp:paragraph {\"align\":\"center\"} -->',\n    '<p class=\"has-text-align-center\">Share a new beat with the Playground uploader.</p>',\n    '<!-- /wp:paragraph -->',\n    '<!-- wp:shortcode -->[beats_cltd_upload_form]<!-- /wp:shortcode -->'\n);\n\n$upload_content = implode(\"\\n\", $upload_blocks);\n\n$beats_page_id = beats_seed_page(\n    array(\n        'post_title'   => 'Beats Demo',\n        'post_name'    => 'beats-demo',\n        'post_content' => $beats_content,\n    )\n);\n\nif ( ! is_wp_error( $beats_page_id ) && $beats_page_id ) {\n    update_option( 'show_on_front', 'page' );\n    update_option( 'page_on_front', $beats_page_id );\n    update_option( 'page_for_posts', 0 );\n}\n\n$upload_page_id = beats_seed_page(\n    array(\n        'post_title'   => 'Upload',\n        'post_name'    => 'upload',\n        'post_content' => $upload_content,\n    )\n);\n\nif ( ! is_wp_error( $upload_page_id ) && $upload_page_id ) {\n    update_post_meta( $upload_page_id, '_wp_page_template', 'default' );\n}\n\nupdate_option( 'blogname', 'Beats' );\n"
    }
  ]
}
